{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://talosprotocol.com/schemas/secrets/envelope.schema.json",
  "title": "Secrets Envelope",
  "description": "Encrypted container for sensitive data using AES-256-GCM.",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "schema_id",
    "schema_version",
    "kek_id",
    "iv",
    "ciphertext",
    "tag",
    "alg"
  ],
  "properties": {
    "schema_id": {
      "const": "talos.secrets.envelope"
    },
    "schema_version": {
      "const": "v1"
    },
    "kek_id": {
      "type": "string",
      "minLength": 1,
      "maxLength": 255,
      "description": "Identifier for the Key Encryption Key (KEK) used to wrap this secret."
    },
    "iv": {
      "type": "string",
      "pattern": "^[0-9a-f]{24}$",
      "description": "12-byte Initialization Vector (IV) in hex."
    },
    "ciphertext": {
      "type": "string",
      "minLength": 2,
      "pattern": "^[0-9a-f]+$",
      "description": "Encrypted payload in hex."
    },
    "tag": {
      "type": "string",
      "pattern": "^[0-9a-f]{32}$",
      "description": "16-byte GCM Authentication Tag in hex."
    },
    "alg": {
      "const": "aes-256-gcm"
    },
    "created_at": {
      "type": "string",
      "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{3}Z$"
    }
  }
}
