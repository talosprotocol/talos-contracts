{
  "$schema": "https://json-schema.org/draft/2019-09/schema",
  "$id": "https://talosprotocol.com/schemas/rbac/org.schema.json",
  "title": "Organization (v2 Hardened)",
  "type": "object",
  "additionalProperties": false,
  "unevaluatedProperties": false,
  "required": ["schema_id", "schema_version", "id", "name", "domain"],
  "properties": {
    "schema_id": { "const": "talos.org" },
    "schema_version": { "const": "v2" },
    "id": { "$ref": "#/$defs/uuidv7" },
    "name": { "type": "string", "minLength": 1, "maxLength": 100 },
    "domain": { 
      "type": "string", 
      "minLength": 3,
      "maxLength": 100,
      "description": "Primary verified domain for the organization."
    },
    "created_by": { "$ref": "#/$defs/uuidv7" },
    "created_at": { "$ref": "#/$defs/rfc3339_utc_ms" }
  },
  "$defs": {
    "uuidv7": {
      "type": "string",
      "pattern": "^[0-9a-f]{8}-[0-9a-f]{4}-7[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$"
    },
    "rfc3339_utc_ms": {
      "type": "string",
      "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{3}Z$"
    }
  }
}
