{
  "description": "Normative Audit Event Vectors (Phase 5.1 Hardened)",
  "tests": [
    {
      "name": "success_bearer_ipv4",
      "event_without_hash": {
        "schema_id": "talos.audit_event",
        "schema_version": "v1",
        "event_id": "01945533-3158-7c85-992d-9865f1715694",
        "ts": "2026-01-11T18:00:00.000Z",
        "request_id": "req-1",
        "surface_id": "llm.invoke",
        "outcome": "success",
        "principal": {
          "auth_mode": "bearer",
          "principal_id": "p-1",
          "team_id": "t-1"
        },
        "http": {
          "method": "POST",
          "path": "/v1/chat/completions",
          "status_code": 200,
          "client_ip_hash": "96e042ef289be4f00339127877576f03107d655586247894f506500265754b30",
          "client_ip_hash_alg": "HMAC-SHA256",
          "client_ip_hash_key_id": "test-ip-key-v1"
        },
        "meta": {
          "model": "gpt-4",
          "tokens": 100
        }
      },
      "input_context": {
        "client_ip": "192.168.1.1",
        "ip_hmac_key": "test-ip-key-secret",
        "ip_hmac_key_id": "test-ip-key-v1"
      },
      "canonical_bytes_hex": "7b226576656e745f6964223a2230313934353533332d333135382d376338352d393932642d393836356631373135363934222c2268747470223a7b22636c69656e745f69705f68617368223a2239366530343265663238396265346630303333393132373837373537366630333130376436353535383632343738393466353036353030323635373534623330222c22636c69656e745f69705f686173685f616c67223a22484d41432d534841323536222c22636c69656e745f69705f686173685f6b65795f6964223a22746573742d69702d6b65792d7631222c226d6574686f64223a22504f5354222c2270617468223a222f76312f636861742f636f6d706c6574696f6e73222c227374617475735f636f6465223a3230307d2c226d657461223a7b226d6f64656c223a226770742d34222c22746f6b656e73223a3130307d2c226f7574636f6d65223a2273756363657373222c227072696e636970616c223a7b22617574685f6d6f6465223a22626561726572222c227072696e636970616c5f6964223a22702d31222c227465616d5f6964223a22742d31227d2c22726571756573745f6964223a227265712d31222c22736368656d615f6964223a2274616c6f732e61756469745f6576656e74222c22736368656d615f76657273696f6e223a227631222c22737572666163655f6964223a226c6c6d2e696e766f6b65222c227473223a22323032362d30312d31315431383a30303a30302e3030305a227d",
      "event_hash": "6a803fcf7040693958c0de56d3d0359ed16625a7df8e21c76b73626716bdb7f7"
    },
    {
      "name": "denied_signed_ipv6",
      "event_without_hash": {
        "schema_id": "talos.audit_event",
        "schema_version": "v1",
        "event_id": "01945533-3158-7c85-992d-9865f1715695",
        "ts": "2026-01-11T18:00:01.000Z",
        "request_id": "req-2",
        "surface_id": "admin.write",
        "outcome": "denied",
        "principal": {
          "auth_mode": "signed",
          "principal_id": "p-2",
          "team_id": "t-2",
          "signer_key_id": "key-sig-1"
        },
        "http": {
          "method": "PUT",
          "path": "/v1/policy",
          "status_code": 403,
          "client_ip_hash": "3b2222f0896661256b62b47bbed3ad68e9e683dc52ddab148402ca19f114237a",
          "client_ip_hash_alg": "HMAC-SHA256",
          "client_ip_hash_key_id": "test-ip-key-v1"
        },
        "meta": {}
      },
      "input_context": {
        "client_ip": "2001:db8::1",
        "ip_hmac_key": "test-ip-key-secret",
        "ip_hmac_key_id": "test-ip-key-v1"
      },
      "canonical_bytes_hex": "7b226576656e745f6964223a2230313934353533332d333135382d376338352d393932642d393836356631373135363935222c2268747470223a7b22636c69656e745f69705f68617368223a2233623232323266303839363636313235366236326234376262656433616436386539653638336463353264646162313438343032636131396631313432333761222c22636c69656e745f69705f686173685f616c67223a22484d41432d534841323536222c22636c69656e745f69705f686173685f6b65795f6964223a22746573742d69702d6b65792d7631222c226d6574686f64223a22505554222c2270617468223a222f76312f706f6c696379222c227374617475735f636f6465223a3430337d2c226d657461223a7b7d2c226f7574636f6d65223a2264656e696564222c227072696e636970616c223a7b22617574685f6d6f6465223a227369676e6564222c227072696e636970616c5f6964223a22702d32222c227369676e65725f6b65795f6964223a226b65792d7369672d31222c227465616d5f6964223a22742d32227d2c22726571756573745f6964223a227265712d32222c22736368656d615f6964223a2274616c6f732e61756469745f6576656e74222c22736368656d615f76657273696f6e223a227631222c22737572666163655f6964223a2261646d696e2e7772697465222c227473223a22323032362d30312d31315431383a30303a30312e3030305a227d",
      "event_hash": "6cf5e81d37136efb932df975cb6e1af8fe7e109a0161e3d078b0588843ebbb6d"
    },
    {
      "name": "anonymous_no_ip",
      "event_without_hash": {
        "schema_id": "talos.audit_event",
        "schema_version": "v1",
        "event_id": "01945533-3158-7c85-992d-9865f1715696",
        "ts": "2026-01-11T18:00:02.000Z",
        "request_id": "req-3",
        "surface_id": "public.read",
        "outcome": "success",
        "principal": {
          "auth_mode": "anonymous",
          "principal_id": "anonymous"
        },
        "http": {
          "method": "GET",
          "path": "/v1/health",
          "status_code": 200
        },
        "meta": {}
      },
      "input_context": {
        "client_ip": null
      },
      "canonical_bytes_hex": "7b226576656e745f6964223a2230313934353533332d333135382d376338352d393932642d393836356631373135363936222c2268747470223a7b226d6574686f64223a22474554222c2270617468223a222f76312f6865616c7468222c227374617475735f636f6465223a3230307d2c226d657461223a7b7d2c226f7574636f6d65223a2273756363657373222c227072696e636970616c223a7b22617574685f6d6f6465223a22616e6f6e796d6f7573222c227072696e636970616c5f6964223a22616e6f6e796d6f7573227d2c22726571756573745f6964223a227265712d33222c22736368656d615f6964223a2274616c6f732e61756469745f6576656e74222c22736368656d615f76657273696f6e223a227631222c22737572666163655f6964223a227075626c69632e72656164222c227473223a22323032362d30312d31315431383a30303a30322e3030305a227d",
      "event_hash": "f31b51220d2e9ddeaa676797f4790963b10ee0acfa0c8b0ff2bc175b7dd0676c"
    },
    {
      "name": "failure_meta_filtered",
      "event_without_hash": {
        "schema_id": "talos.audit_event",
        "schema_version": "v1",
        "event_id": "01945533-3158-7c85-992d-9865f1715697",
        "ts": "2026-01-11T18:00:03.000Z",
        "request_id": "req-4",
        "surface_id": "llm.invoke",
        "outcome": "failure",
        "principal": {
          "auth_mode": "bearer",
          "principal_id": "p-1",
          "team_id": "t-1"
        },
        "http": {
          "method": "POST",
          "path": "/v1/chat/completions",
          "status_code": 500
        },
        "meta": {
          "error": "Timeout",
          "tokens": 0
        }
      },
      "input_context": {
        "client_ip": "unknown",
        "unfiltered_meta": {
          "error": "Timeout",
          "tokens": 0,
          "secret_key": "REMOVE_ME"
        }
      },
      "canonical_bytes_hex": "7b226576656e745f6964223a2230313934353533332d333135382d376338352d393932642d393836356631373135363937222c2268747470223a7b226d6574686f64223a22504f5354222c2270617468223a222f76312f636861742f636f6d706c6574696f6e73222c227374617475735f636f6465223a3530307d2c226d657461223a7b226572726f72223a2254696d656f7574222c22746f6b656e73223a307d2c226f7574636f6d65223a226661696c757265222c227072696e636970616c223a7b22617574685f6d6f6465223a22626561726572222c227072696e636970616c5f6964223a22702d31222c227465616d5f6964223a22742d31227d2c22726571756573745f6964223a227265712d34222c22736368656d615f6964223a2274616c6f732e61756469745f6576656e74222c22736368656d615f76657273696f6e223a227631222c22737572666163655f6964223a226c6c6d2e696e766f6b65222c227473223a22323032362d30312d31315431383a30303a30332e3030305a227d",
      "event_hash": "179f1d9026695135a87e30d6a3622d194a11ba7a2361f1a734e907b6241caab9"
    },
    {
      "name": "meta_filtering_normative",
      "event_without_hash": {
        "schema_id": "talos.audit_event",
        "schema_version": "v1",
        "event_id": "01945533-3158-7c85-992d-9865f1715698",
        "ts": "2026-01-11T18:00:04.000Z",
        "request_id": "req-5",
        "surface_id": "llm.invoke",
        "outcome": "success",
        "principal": {
          "auth_mode": "bearer",
          "principal_id": "p-1",
          "team_id": "t-1"
        },
        "http": {
          "method": "POST",
          "path": "/v1/chat/completions",
          "status_code": 200
        },
        "meta": {
          "meta_redacted_keys": "internal_id, raw_request",
          "meta_redaction_applied": true,
          "model": "gpt-4",
          "tokens": 150
        }
      },
  "input_context": {
    "unfiltered_meta": {
      "model": "gpt-4",
      "tokens": 150,
      "internal_id": "delete-me",
      "raw_request": "delete-me-too"
    }
  },
  "canonical_bytes_hex": "7b226576656e745f6964223a2230313934353533332d333135382d376338352d393932642d393836356631373135363938222c2268747470223a7b226d6574686f64223a22504f5354222c2270617468223a222f76312f636861742f636f6d706c6574696f6e73222c227374617475735f636f6465223a3230307d2c226d657461223a7b226d6574615f72656461637465645f6b657973223a22696e7465726e616c5f69642c207261775f72657175657374222c226d6574615f726564616374696f6e5f6170706c696564223a747275652c226d6f64656c223a226770742d34222c22746f6b656e73223a3135307d2c226f7574636f6d65223a2273756363657373222c227072696e636970616c223a7b22617574685f6d6f6465223a22626561726572222c227072696e636970616c5f6964223a22702d31222c227465616d5f6964223a22742d31227d2c22726571756573745f6964223a227265712d35222c22736368656d615f6964223a2274616c6f732e61756469745f6576656e74222c22736368656d615f76657273696f6e223a227631222c22737572666163655f6964223a226c6c6d2e696e766f6b65222c227473223a22323032362d30312d31315431383a30303a30342e3030305a227d",
  "event_hash": "b673d04fa9b37a18f7394d60fa8d41665ad7895c836cb0711d7b16c50a36eba5"
}
  ]
}
