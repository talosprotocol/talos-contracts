{
  "name": "recover_divergence",
  "description": "Detection of a tampered hash chain during recovery",
  "input": {
    "trace_id": "018d0a5a-5a5a-7a5a-8a5a-5a5a5a5a5a5a"
  },
  "fixtures": {
    "entries": [
      {
        "schema_id": "talos.tga.execution_log_entry",
        "schema_version": "v1",
        "trace_id": "018d0a5a-5a5a-7a5a-8a5a-5a5a5a5a5a5a",
        "principal_id": "018d0a5a-5a5a-7a5a-8a5a-5a5a5a5a5a5a",
        "seq": 1,
        "ts": "2026-01-24T15:00:00.000Z",
        "from_state": "PENDING",
        "to_state": "AUTHORIZED",
        "artifact_type": "action_request",
        "artifact_id": "018d0a5a-5a5a-7a5a-8a5a-5a5a5a5a5a51",
        "artifact_digest": "YXJ0aWZhY3RfZGlnZXN0XzFfX19fX19fX19fX19fX19fX18",
        "prev_entry_digest": "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
        "entry_digest": "ZW50cnlfMV9kaWdlc3RfX19fX19fX19fX19fX19fX18"
      }
    ]
  },
  "expected": {
    "chain_valid": false,
    "divergence_point": "2",
    "latest_entry_digest": "ZW50cnlfMV9kaWdlc3RfX19fX19fX19fX19fX19fX18",
    "entry_count": 3,
    "last_seq": 3,
    "recommended_action": "FULL_REPLAY",
    "re_dispatch_required": true
  }
}
